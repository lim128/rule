# 机场订阅
proxy-providers:
  Airport1:
    url: ""
    type: http
    path: ./proxies/.yaml
    interval: 86400
    health-check:
      enable: true
      url: https://www.gstatic.com/generate_204
      interval: 300
# 全局配置 
port: 7890
socks-port: 7891
redir-port: 7892
mixed-port: 7893
tproxy-port: 7895
allow-lan: true
bind-address: "*"
ipv6: true
mode: Rule
external-controller: :9090
geodata-mode: true
geodata-loader: standard
geo-auto-update: true
geo-update-interval: 24
geox-url:
  geoip: https://ghfast.top/https://github.com/DustinWin/ruleset_geodata/releases/download/mihomo-geodata/geoip.dat
  geosite: https://ghfast.top/https://github.com/DustinWin/ruleset_geodata/releases/download/mihomo-geodata/geosite.dat
  asn: https://testingcf.jsdelivr.net/gh/xishang0128/geoip@release/GeoLite2-ASN.mmdb
# 出站策略
proxy-groups:
- name: 节点选择
  type: select
  proxies:
  - 故障转移
  - 自动选择
  - 手动切换
  - 美国节点
  - 日本节点
  - 新加坡节点
  - 香港节点
  - 其他节点
  - 直连
  icon: "https://ghfast.top/https://github.com/DustinWin/ruleset_geodata/releases/download/icons/global.png"
- name: 故障转移
  type: fallback
  interval: 180
  proxies:
  - 美国节点
  - 日本节点
  - 新加坡节点
  - 香港节点
  - 其他节点
  icon: "https://cdn.jsdelivr.net/gh/blackmatrix7/ios_rule_script@master/icon/qure/color/Drill.png"
- name: 自动选择
  type: url-test
  include-all: true
  interval: 180
  tolerance: 300
  filter: "^(?i)(?!.*(重置|到期|过期|剩余|套餐|返利|官网|群组|Expiration|Remaining)).*$"
  icon: "https://cdn.jsdelivr.net/gh/blackmatrix7/ios_rule_script@master/icon/color/speedtest.png"
- name: 手动切换
  type: select
  include-all: true
  filter: "^(?i)(?!.*(重置|到期|过期|剩余|套餐|返利|官网|群组|Expiration|Remaining)).*$"
  icon: "https://ghfast.top/https://github.com/DustinWin/ruleset_geodata/releases/download/icons/proxy.png"
- name: 人工智能
  type: select
  include-all: true
  filter: "(?i).*(美|波特兰|达拉斯|俄勒冈|凤凰城|费利蒙|硅谷|拉斯维加斯|洛杉矶|圣何塞|圣克拉拉|西雅图|芝加哥|US|United States).*$"
  icon: "https://ghfast.top/https://github.com/DustinWin/ruleset_geodata/releases/download/icons/ai.png"
#- name: 高级节点
#  type: select
#  include-all: true
#  filter: "(?i).*(专线|专用|高级|直连|急速|高倍率|游戏|game|IEPL|IPLC|AIA|CTM|CC|AC|x[2-9]|x[1-9][0-9]+).*$"
#  icon: "https://cdn.jsdelivr.net/gh/blackmatrix7/ios_rule_script@master/icon/color/hot.png"
- name: 美国节点
  type: fallback
  include-all: true
  interval: 180
  filter: "(?i).*(美|波特兰|达拉斯|俄勒冈|凤凰城|费利蒙|硅谷|拉斯维加斯|洛杉矶|圣何塞|圣克拉拉|西雅图|芝加哥|US|United States).*$"
  icon: "https://ghfast.top/https://github.com/DustinWin/ruleset_geodata/releases/download/icons/unitedstates.png"
- name: 日本节点
  type: fallback
  include-all: true
  interval: 180
  filter: "(?i).*(日本|川日|东京|大阪|泉日|埼玉|沪日|深日|JP|Japan).*$"
  icon: "https://ghfast.top/https://github.com/DustinWin/ruleset_geodata/releases/download/icons/japan.png"
- name: 新加坡节点
  type: fallback
  include-all: true
  interval: 180
  filter: "(?i).*(新加坡|坡|狮城|SG|Singapore).*$"
  icon: "https://ghfast.top/https://github.com/DustinWin/ruleset_geodata/releases/download/icons/singapore.png"
- name: 香港节点
  type: fallback
  include-all: true
  interval: 180
  filter: "(?i).*(港|HK|hk|Hong Kong|HongKong|hongkong).*$"
  icon: "https://ghfast.top/https://github.com/DustinWin/ruleset_geodata/releases/download/icons/hongkong.png"
- name: 其他节点
  type: url-test
  include-all: true
  interval: 180
  tolerance: 300
  filter: "^(?i)(?!.*(重置|到期|过期|剩余|套餐|返利|官网|群组|Expiration|Remaining|美|波特兰|达拉斯|俄勒冈|凤凰城|费利蒙|硅谷|拉斯维加斯|洛杉矶|圣何塞|圣克拉拉|西雅图|芝加哥|US|United States|日本|川日|东京|大阪|泉日|埼玉|沪日|深日|JP|Japan|新加坡|坡|狮城|SG|Singapore|港|HK|hk|Hong Kong|HongKong|hongkong)).*$"
  icon: "https://cdn.jsdelivr.net/gh/blackmatrix7/ios_rule_script@master/icon/color/ss.png"
- name: 直连
  type: select
  proxies:
  - DIRECT
  hidden: true
  icon: "https://ghfast.top/https://github.com/DustinWin/ruleset_geodata/releases/download/icons/direct.png"
- name: 拒绝
  type: select
  proxies:
  - REJECT
  hidden: true
  icon: "https://github.com/DustinWin/ruleset_geodata/releases/download/icons/reject.png"
- name: 漏网之鱼
  type: select
  proxies:
  - 节点选择
  - 直连
  icon: "https://ghfast.top/https://github.com/DustinWin/ruleset_geodata/releases/download/icons/match.png"
# 规则匹配
rules:
- GEOSITE,private,直连
- GEOSITE,ai,人工智能
- RULE-SET,apple,直连
- GEOSITE,microsoft-cn,直连
- GEOSITE,networktest,直连
- GEOSITE,trackerslist,直连
- RULE-SET,telegram,节点选择
- GEOSITE,tld-proxy,节点选择
- GEOSITE,proxy,节点选择
- GEOSITE,cn,直连
- RULE-SET,cnip,直连,no-resolve
- GEOIP,private,直连,no-resolve
- GEOIP,cn,直连
- MATCH,漏网之鱼
# 规则集
rule-providers:
  apple:
    type: http
    behavior: classical
    format: yaml
    path: ./rules/apple.yaml
    url: "https://cdn.jsdelivr.net/gh/blackmatrix7/ios_rule_script@master/rule/Clash/Apple/Apple_Classical.yaml"
    interval: 86400
  telegram:
    type: http
    behavior: classical
    format: yaml
    path: ./rules/telegram.yaml
    url: "https://cdn.jsdelivr.net/gh/blackmatrix7/ios_rule_script@master/rule/Clash/Telegram/Telegram_No_Resolve.yaml"
    interval: 86400
  cnip:
    type: http
    behavior: ipcidr
    format: mrs
    path: ./rules/cnip.mrs
    url: "https://ghfast.top/https://github.com/DustinWin/ruleset_geodata/releases/download/mihomo-ruleset/cnip.mrs"
    interval: 86400
# DNS
dns:
  enable: true
  listen: 0.0.0.0:1053
  ipv6: true
  enhanced-mode: fake-ip
  fake-ip-range: 198.18.0.1/16
  fake-ip-filter-mode: blacklist
  nameserver:
  - https://223.5.5.5/dns-query
  proxy-server-nameserver:
  - https://223.5.5.5/dns-query
  default-nameserver:
  - 223.5.5.5
  fake-ip-filter:
  - geosite:fakeip-filter
  - "+.vion.top"
